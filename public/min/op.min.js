firebase.initializeApp({apiKey:"AIzaSyDMte7b_-fC_0FHWF4HLOQAsPUFiaVCiC4",authDomain:"pruebarepresentaciones.firebaseapp.com",databaseURL:"https://pruebarepresentaciones.firebaseio.com",projectId:"pruebarepresentaciones",storageBucket:"pruebarepresentaciones.appspot.com",messagingSenderId:"193911640535",appId:"1:193911640535:web:97a9a4384f2c2173b8bb92",measurementId:"G-JV5GCTR8P2"});var db=firebase.firestore();function Seguimiento(){confirm("Seguro que desea CAMBIAR de pagina?")&&(window.location.href="controlSeguimiento.html")}function imprimirOP(){(document.getElementById("registrarOP").style.display="none",document.getElementById("consultarOP").style.display="none",document.getElementById("actualizarOP").style.display="none",document.getElementById("EliminarOP").style.display="none",document.getElementById("imprimirOP").style.display="none",""==document.getElementById("talla1").value)&&(document.getElementById("talla1").style.display="none");""==document.getElementById("talla2").value&&(document.getElementById("talla2").style.display="none");""==document.getElementById("talla3").value&&(document.getElementById("talla3").style.display="none");""==document.getElementById("talla4").value&&(document.getElementById("talla4").style.display="none");""==document.getElementById("talla5").value&&(document.getElementById("talla5").style.display="none");""==document.getElementById("talla6").value&&(document.getElementById("talla6").style.display="none");""==document.getElementById("talla7").value&&(document.getElementById("talla7").style.display="none");""==document.getElementById("talla8").value&&(document.getElementById("talla8").style.display="none");""==document.getElementById("talla9").value&&(document.getElementById("talla9").style.display="none");""==document.getElementById("talla10").value&&(document.getElementById("talla10").style.display="none");""==document.getElementById("cantiTa1").value&&(document.getElementById("cantiTa1").style.display="none");""==document.getElementById("cantiTa2").value&&(document.getElementById("cantiTa2").style.display="none");""==document.getElementById("cantiTa3").value&&(document.getElementById("cantiTa3").style.display="none");""==document.getElementById("cantiTa4").value&&(document.getElementById("cantiTa4").style.display="none");""==document.getElementById("cantiTa5").value&&(document.getElementById("cantiTa5").style.display="none");""==document.getElementById("cantiTa6").value&&(document.getElementById("cantiTa6").style.display="none");""==document.getElementById("cantiTa7").value&&(document.getElementById("cantiTa7").style.display="none");""==document.getElementById("cantiTa8").value&&(document.getElementById("cantiTa8").style.display="none");""==document.getElementById("cantiTa9").value&&(document.getElementById("cantiTa9").style.display="none");""==document.getElementById("cantiTa10").value&&(document.getElementById("cantiTa10").style.display="none");window.print?window.print():alert("Puede utilizar ctrl+P")}function actualizarOP(){actuali()}function RegistrarOP(){var e=document.getElementById("orden").value,t=document.getElementById("ref").value,a=document.getElementById("cliente").value,d=document.getElementById("fi").value,n=document.getElementById("lote").value,l=document.getElementById("tipo").value,o=document.getElementById("tipo2").value,i=(document.getElementById("canti").value,document.getElementById("salida").value),c=document.getElementById("talla1").value,m=document.getElementById("talla2").value,u=document.getElementById("talla3").value,g=document.getElementById("talla4").value,y=document.getElementById("talla5").value,r=document.getElementById("talla6").value,E=document.getElementById("talla7").value,I=document.getElementById("talla8").value,s=document.getElementById("talla9").value,B=document.getElementById("talla10").value,C=c+" "+m+" "+u+" "+g+" "+y+" "+r+" "+E+" "+I+" "+s+" "+B;console.log(C);var v=document.getElementById("tallas").value=C;var T=Number(document.getElementById("canti").value),p=Number(document.getElementById("cantiTa1").value),$=Number(document.getElementById("cantiTa2").value),f=Number(document.getElementById("cantiTa3").value),b=Number(document.getElementById("cantiTa4").value),P=Number(document.getElementById("cantiTa5").value),h=Number(document.getElementById("cantiTa6").value),O=Number(document.getElementById("cantiTa7").value),N=Number(document.getElementById("cantiTa8").value),R=Number(document.getElementById("cantiTa9").value),F=Number(document.getElementById("cantiTa10").value),S=p+$+f+b+P+h+O+N+R+F,w=document.getElementById("resulEstado").value;S>T&&alert("Ha excedido la cantidad maxima, favor revise las cantidades..."),T>S&&alert("Faltan unidades por Registrar..."),T==S&&(confirm("Seguro que desea COMPLETAR el registro?")?(RegistroValidacion(),db.collection("OrdenProduccion").add({OrdenP:e,Referenc:t,Cliente:a,FechaIngreso:d,Lote:n,Tallas:v,Tipo:l,Tipo2:o,Cantidad:T,Salida:i,Talla1:c,Cantidad1:p,Talla2:m,Cantidad2:$,Talla3:u,Cantidad3:f,Talla4:g,Cantidad4:b,Estado:w,Talla5:y,Cantidad5:P,Talla6:r,Cantidad6:h,Talla7:E,Cantidad7:O,Talla8:I,Cantidad8:N,Talla9:s,Cantidad9:R,Talla10:B,Cantidad10:F}).then(function(){alert("Registro Exitoso"),console.log("Document successfully written!"),limpiarV()}).catch(function(e){alert("No se pudo completar el registro"),console.error("Error writing document: ",e)})):alert("Ha cancelado el Registro..."))}function consultarOP(){var e=document.getElementById("orden").value;document.getElementById("ref"),document.getElementById("cliente"),document.getElementById("fi"),document.getElementById("lote"),document.getElementById("tallas"),document.getElementById("tipo"),document.getElementById("tipo2"),document.getElementById("canti"),document.getElementById("salida"),document.getElementById("talla1"),document.getElementById("cantiTa1"),document.getElementById("talla2"),document.getElementById("cantiTa2"),document.getElementById("talla3"),document.getElementById("cantiTa3"),document.getElementById("talla4"),document.getElementById("cantiTa4"),document.getElementById("talla5"),document.getElementById("cantiTa5"),document.getElementById("talla6"),document.getElementById("cantiTa6"),document.getElementById("talla7"),document.getElementById("cantiTa7"),document.getElementById("talla8"),document.getElementById("cantiTa8"),document.getElementById("talla9"),document.getElementById("cantiTa9"),document.getElementById("talla10"),document.getElementById("cantiTa10");""!=e?db.collection("OrdenProduccion").where("OrdenP","==",e).get().then(function(e){e.forEach(function(e){console.log(e.id," => ",e.data());e.data().OrdenP;var t=`${e.data().Referenc}`,a=`${e.data().Cliente}`,d=`${e.data().FechaIngreso}`,n=`${e.data().Lote}`,l=`${e.data().Tallas}`,o=`${e.data().Tipo}`,i=`${e.data().Tipo2}`,c=`${e.data().Cantidad}`,m=`${e.data().Salida}`,u=`${e.data().Talla1}`,g=`${e.data().Cantidad1}`,y=`${e.data().Talla2}`,r=`${e.data().Cantidad2}`,E=`${e.data().Talla3}`,I=`${e.data().Cantidad3}`,s=`${e.data().Talla4}`,B=`${e.data().Cantidad4}`,C=`${e.data().Talla5}`,v=`${e.data().Cantidad5}`,T=`${e.data().Talla6}`,p=`${e.data().Cantidad6}`,$=`${e.data().Talla7}`,f=`${e.data().Cantidad7}`,b=`${e.data().Talla8}`,P=`${e.data().Cantidad8}`,h=`${e.data().Talla9}`,O=`${e.data().Cantidad9}`,N=`${e.data().Talla10}`,R=`${e.data().Cantidad10}`,F=`${e.data().Estado}`;0==g&&(document.getElementById("cantiTa1").value=""),0!=g&&(document.getElementById("cantiTa1").value=g),0==r&&(document.getElementById("cantiTa2").value=""),0!=r&&(document.getElementById("cantiTa2").value=r),0==I&&(document.getElementById("cantiTa3").value=""),0!=I&&(document.getElementById("cantiTa3").value=I),0==B&&(document.getElementById("cantiTa4").value=""),0!=B&&(document.getElementById("cantiTa4").value=B),0==v&&(document.getElementById("cantiTa5").value=""),0!=v&&(document.getElementById("cantiTa5").value=v),0==p&&(document.getElementById("cantiTa6").value=""),0!=p&&(document.getElementById("cantiTa6").value=p),0==f&&(document.getElementById("cantiTa7").value=""),0!=f&&(document.getElementById("cantiTa7").value=f),0==P&&(document.getElementById("cantiTa8").value=""),0!=P&&(document.getElementById("cantiTa8").value=P),0==O&&(document.getElementById("cantiTa9").value=""),0!=O&&(document.getElementById("cantiTa9").value=O),0==R&&(document.getElementById("cantiTa10").value=""),0!=R&&(document.getElementById("cantiTa10").value=R),document.getElementById("resulEstado").value=F,document.getElementById("ref").value=t,document.getElementById("cliente").value=a,document.getElementById("fi").value=d,document.getElementById("lote").value=n,document.getElementById("tallas").value=l,document.getElementById("tipo").value=o,document.getElementById("tipo2").value=i,document.getElementById("canti").value=c,document.getElementById("salida").value=m,document.getElementById("talla1").value=u,document.getElementById("talla2").value=y,document.getElementById("talla3").value=E,document.getElementById("talla4").value=s,document.getElementById("talla5").value=C,document.getElementById("talla6").value=T,document.getElementById("talla7").value=$,document.getElementById("talla8").value=b,document.getElementById("talla9").value=h,document.getElementById("talla10").value=N,document.getElementById("actualizarOP").style.display="block",document.getElementById("EliminarOP").style.display="block",document.getElementById("imprimirOP").style.display="block",elimi=function(){db.collection("OrdenProduccion").doc(e.id).delete().then(function(){alert("Ha eliminado el Registro"),limpiarV(),document.getElementById("actualizarOP").style.display="none",document.getElementById("EliminarOP").style.display="none",document.getElementById("imprimirOP").style.display="none",console.log("Document successfully deleted!")}).catch(function(e){alert("No se ha podido eliminar el documento"),console.error("Error removing document: ",e)})},actuali=function(){var t=document.getElementById("orden").value,a=document.getElementById("ref").value,d=document.getElementById("cliente").value,n=document.getElementById("fi").value,l=document.getElementById("lote").value,o=document.getElementById("tallas").value,i=document.getElementById("tipo").value,c=document.getElementById("tipo2").value,m=(document.getElementById("canti").value,document.getElementById("salida").value),u=document.getElementById("talla1").value,g=document.getElementById("talla2").value,y=document.getElementById("talla3").value,r=document.getElementById("talla4").value,E=document.getElementById("talla5").value,I=document.getElementById("talla6").value,s=document.getElementById("talla7").value,B=document.getElementById("talla8").value,C=document.getElementById("talla9").value,v=document.getElementById("talla10").value,T=u+" "+g+" "+y+" "+r+" "+E+" "+I+" "+s+" "+B+" "+C+" "+v;console.log(T);o=document.getElementById("tallas").value=T;var p=Number(document.getElementById("canti").value),$=Number(document.getElementById("cantiTa1").value),f=Number(document.getElementById("cantiTa2").value),b=Number(document.getElementById("cantiTa3").value),P=Number(document.getElementById("cantiTa4").value),h=Number(document.getElementById("cantiTa5").value),O=Number(document.getElementById("cantiTa6").value),N=Number(document.getElementById("cantiTa7").value),R=Number(document.getElementById("cantiTa8").value),F=Number(document.getElementById("cantiTa9").value),S=Number(document.getElementById("cantiTa10").value),w=$+f+b+P+h+O+N+R+F+S,A=document.getElementById("resulEstado").value;if(w>p&&alert("Ha excedido la cantidad maxima, favor revise las cantidades..."),p>w&&alert("Faltan unidades por Registrar..."),p==w){if(confirm("Seguro que desea ACTUALIZAR el registro?"))return db.collection("OrdenProduccion").doc(e.id).update({OrdenP:t,Referenc:a,Cliente:d,FechaIngreso:n,Lote:l,Tallas:o,Tipo:i,Tipo2:c,Cantidad:p,Salida:m,Talla1:u,Cantidad1:$,Talla2:g,Cantidad2:f,Talla3:y,Cantidad3:b,Talla4:r,Cantidad4:P,Estado:A,Talla5:E,Cantidad5:h,Talla6:I,Cantidad6:O,Talla7:s,Cantidad7:N,Talla8:B,Cantidad8:R,Talla9:C,Cantidad9:F,Talla10:v,Cantidad10:S}).then(function(){alert("Actualizacion exitosa!!!"),estadoFicha(),limpiarV(),document.getElementById("actualizarOP").style.display="none",document.getElementById("EliminarOP").style.display="none",document.getElementById("imprimirOP").style.display="none",console.log("Document successfully updated!")}).catch(function(e){console.error("Error updating document: ",e)});alert("Ha cancelado la Actualizacion...")}}})}):alert("Ingrese el # de OP a consultar")}function eliminarOP(){confirm("Seguro que desea ELIMINAR el documento?")?elimi():alert("Ha cancelado el proceso...")}limpiarV=function(){document.getElementById("orden").value="",document.getElementById("ref").value="",document.getElementById("cliente").value="",document.getElementById("fi").value="",document.getElementById("lote").value="",document.getElementById("tallas").value="",document.getElementById("tipo").value="",document.getElementById("canti").value="",document.getElementById("salida").value="",document.getElementById("tipo2").value="",document.getElementById("talla1").value="",document.getElementById("cantiTa1").value="",document.getElementById("talla2").value="",document.getElementById("cantiTa2").value="",document.getElementById("talla3").value="",document.getElementById("cantiTa3").value="",document.getElementById("talla4").value="",document.getElementById("cantiTa4").value="",document.getElementById("talla5").value="",document.getElementById("cantiTa5").value="",document.getElementById("talla6").value="",document.getElementById("cantiTa6").value="",document.getElementById("talla7").value="",document.getElementById("cantiTa7").value="",document.getElementById("talla8").value="",document.getElementById("cantiTa8").value="",document.getElementById("talla9").value="",document.getElementById("cantiTa9").value="",document.getElementById("talla10").value="",document.getElementById("cantiTa10").value=""},RegistroValidacion=function(){var e=document.getElementById("ref").value,t=document.getElementById("orden").value,a=Number(document.getElementById("canti").value);db.collection("FichaTecniGlobal").where("Referencia","==",e).get().then(function(d){d.forEach(function(d){console.log(d.id," => ",d.data());var n=`${d.data().Codigo}`,l=`${d.data().Codigo2}`,o=`${d.data().Codigo3}`,i=`${d.data().Codigo4}`,c=`${d.data().Codigo5}`,m=`${d.data().Codigo6}`,u=`${d.data().Codigo7}`,g=`${d.data().Codigo8}`,y=`${d.data().Codigo9}`,r=`${d.data().Codigo10}`,E=`${d.data().Codigo11}`,I=`${d.data().Codigo12}`,s=`${d.data().Codigo13}`,B=`${d.data().Codigo14}`,C=`${d.data().Codigo15}`,v=`${d.data().Codigo16}`,T=`${d.data().Codigo17}`,p=`${d.data().Codigo18}`,$=`${d.data().Codigo19}`,f=`${d.data().Codigo20}`,b=`${d.data().Codigo21}`,P=`${d.data().Codigo22}`,h=`${d.data().Codigo23}`,O=`${d.data().Codigo24}`,N=`${d.data().Codigo25}`,R=`${d.data().Codigo26}`,F=`${d.data().Codigo27}`,S=`${d.data().Codigo28}`,w=`${d.data().Codigo29}`,A=`${d.data().Codigo30}`,z=`${d.data().Codigo31}`,_=`${d.data().Codigo32}`,D=`${d.data().Codigo33}`,L=`${d.data().Codigo34}`,M=`${d.data().Codigo35}`,x=`${d.data().Codigo36}`,V=`${d.data().Codigo37}`,H=`${d.data().Codigo38}`,G=`${d.data().Codigo39}`,k=`${d.data().Codigo40}`,q=`${d.data().Codigo41}`,U=`${d.data().Codigo42}`,j=`${d.data().Codigo43}`,J=`${d.data().Codigo44}`,K=`${d.data().Codigo45}`,Q=`${d.data().Codigo46}`,W=`${d.data().Codigo47}`,X=`${d.data().Codigo48}`,Z=`${d.data().Codigo49}`,Y=`${d.data().Codigo50}`;console.log("variable antes de nan"+l),db.collection("CantidadesDisponibles").add({OP:t,Referenc:e,Codigo:n,Codigo2:l,Codigo3:o,Codigo4:i,Codigo5:c,Codigo6:m,Codigo7:u,Codigo8:g,Codigo9:y,Codigo10:r,Codigo11:E,Codigo12:I,Codigo13:s,Codigo14:B,Codigo15:C,Codigo16:v,Codigo17:T,Codigo18:p,Codigo19:$,Codigo20:f,Codigo21:b,Codigo22:P,Codigo23:h,Codigo24:O,Codigo25:N,Codigo26:R,Codigo27:F,Codigo28:S,Codigo29:w,Codigo30:A,Codigo31:z,Codigo32:_,Codigo33:D,Codigo34:L,Codigo35:M,Codigo36:x,Codigo37:V,Codigo38:H,Codigo39:G,Codigo40:k,Codigo41:q,Codigo42:U,Codigo43:j,Codigo44:J,Codigo45:K,Codigo46:Q,Codigo47:W,Codigo48:X,Codigo49:Z,Codigo50:Y,cantiCod1:a,cantiCod2:a,cantiCod3:a,cantiCod4:a,cantiCod5:a,cantiCod6:a,cantiCod7:a,cantiCod8:a,cantiCod9:a,cantiCod10:a,cantiCod11:a,cantiCod12:a,cantiCod13:a,cantiCod14:a,cantiCod15:a,cantiCod16:a,cantiCod17:a,cantiCod18:a,cantiCod19:a,cantiCod20:a,cantiCod21:a,cantiCod22:a,cantiCod23:a,cantiCod24:a,cantiCod25:a,cantiCod26:a,cantiCod27:a,cantiCod28:a,cantiCod29:a,cantiCod30:a,cantiCod31:a,cantiCod32:a,cantiCod33:a,cantiCod34:a,cantiCod35:a,cantiCod36:a,cantiCod37:a,cantiCod38:a,cantiCod39:a,cantiCod40:a,cantiCod41:a,cantiCod42:a,cantiCod43:a,cantiCod44:a,cantiCod45:a,cantiCod46:a,cantiCod47:a,cantiCod48:a,cantiCod49:a,cantiCod50:a}).then(function(){alert("Registro Exitoso"),console.log("Document successfully written!")}).catch(function(e){alert("No se pudo completar el registro"),console.error("Error writing document: ",e)})})})},window.onload=function(){document.getElementById("actualizarOP").style.display="none",document.getElementById("EliminarOP").style.display="none",document.getElementById("imprimirOP").style.display="none",dataSet=new Array;document.getElementById("tabla");db.collection("OrdenProduccion").orderBy("OrdenP","desc").limit(2e3).onSnapshot(e=>{e.forEach(function(e){console.log(e.id," => ",e.data());var t=`${e.data().OrdenP}`,a=`${e.data().Referenc}`,d=`${e.data().Cliente}`,n=`${e.data().Cantidad}`,l=`${e.data().FechaIngreso}`,o=`${e.data().Estado}`;dataSet.push([t,a,d,n,l,o]),1,$(document).ready(function(){$("#dtVerticalScrollExample").DataTable({data:dataSet,bDestroy:!0,columns:[{title:"#OP"},{title:"Referencia"},{title:"Cliente"},{title:"Cantidad"},{title:"Fecha Ingreso"},{title:"Estado"}],language:{lengthMenu:"Mostrar _MENU_ registros",zeroRecords:"No se encontraron resultados",info:"Mostrando registros del _START_ al _END_ de un total de _TOTAL_ registros",infoEmpty:"Mostrando registros del 0 al 0 de un total de 0 registros",infoFiltered:"(filtrado de un total de _MAX_ registros)",sSearch:"Buscar:",oPaginate:{sFirst:"Primero",sLast:"Ãšltimo",sNext:"Siguiente",sPrevious:"Anterior"},sProcessing:"Procesando..."}})})})})},estadoFicha=function(){estadoFic=document.getElementById("resulEstado").value,datoRef=document.getElementById("ref").value,enviarCliente=document.getElementById("cliente").value,db.collection("FichaTecniGlobal").where("Referencia","==",datoRef).where("Cliente","==",enviarCliente).get().then(function(e){e.forEach(function(e){return console.log(e.id," => ",e.data()),db.collection("FichaTecniGlobal").doc(e.id).update({Estado:estadoFic}).then(function(){console.log("Document successfully updated!")}).catch(function(e){console.error("Error updating document: ",e)})})})};